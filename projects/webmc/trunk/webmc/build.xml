<!--
  ~ Version: MPL 1.1/GPL 2.0/LGPL 2.1
  ~
  ~ "The contents of this file are subject to the Mozilla Public License
  ~ Version 1.1 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://www.mozilla.org/MPL/
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations under
  ~ the License.
  ~
  ~ The Original Code is ICEfaces 1.5 open source software code, released
  ~ November 5, 2006. The Initial Developer of the Original Code is ICEsoft
  ~ Technologies Canada, Corp. Portions created by ICEsoft are Copyright (C)
  ~ 2004-2006 ICEsoft Technologies Canada, Corp. All Rights Reserved.
  ~
  ~ Contributor(s): _____________________.
  ~
  ~ Alternatively, the contents of this file may be used under the terms of
  ~ the GNU Lesser General Public License Version 2.1 or later (the "LGPL"
  ~ License), in which case the provisions of the LGPL License are
  ~ applicable instead of those above. If you wish to allow use of your
  ~ version of this file only under the terms of the LGPL License and not to
  ~ allow others to use your version of this file under the MPL, indicate
  ~ your decision by deleting the provisions above and replace them with
  ~ the notice and other provisions required by the LGPL License. If you do
  ~ not delete the provisions above, a recipient may use your version of
  ~ this file under either the MPL or the LGPL License."
  ~
  -->
<project name="webmc" default="build.war">

	<!-- The basic build.properties file for customization -->
	<property file="build.properties" />

	<!-- compile settings overridden from -->
	<property name="compile.source" value="1.5" />
	<property name="compile.target" value="1.5" />
	<property name="compile.debug" value="true" />

	<!-- path to applicaiton libraries -->
	<property name="proj.lib.dir" location="lib/" />
	<property name="ice.lib.dir" location="../../icefaces/trunk/icefaces/lib/" />

	<property name="app.build.dir" location="build" />
	<property name="app.dist.dir" location="dist" />

	<patternset id="additional.compile.lib.jars" includes="servlet-api.jar " />

	<!-- jars needed for form validation -->
	<patternset id="validation.jars" includes="
        commons-validator-1.2.0.jar
        oro-gump-28042006.jar
        " />
	<!-- jars needed for JavaMail -->
	<patternset id="javaMail.jars" includes="
        dsn.jar
        imap.jar
        mail.jar
        mailapi.jar
        pop3.jar
        smtp.jar
        activation.jar
        " />

	<!-- jars needed for Facelets -->
	<patternset id="facelets.jars" includes="
        krysalis-jCharts-1.0.0-alpha-1.jar
        el-ri.jar
        " />

	<target name="clean">
		<delete quiet="true">
			<fileset dir="${app.build.dir}" includes="*.jar" />
		</delete>
		<delete dir="${app.build.dir}" />
		<delete dir="${app.dist.dir}" />
		<mkdir dir="${app.build.dir}" />
		<mkdir dir="${app.dist.dir}" />
	</target>

	<target name="compile" depends="clean">
		<javac srcdir="src" destdir="${app.build.dir}" includeantruntime="false" debug="on">
			<classpath>
				<fileset dir="${ice.lib.dir}">
					<include name="**/*.jar" />
				</fileset>

				<fileset dir="${proj.lib.dir}">
					<include name="**/*.jar" />
				</fileset>
			</classpath>
		</javac>
		<copy todir="${app.build.dir}">
			<fileset dir="src" includes="**/*.properties" />
		</copy>

	</target>

	<target name="build.war" depends="compile">
		<war destfile="${app.dist.dir}\webmc.war" webxml="web/WEB-INF/web.xml">
			<fileset dir="web/" />
			<lib dir="${ice.lib.dir}">
				<include name="icefaces.jar" />
				<include name="icefaces-compat.jar" />
				<include name="icefaces-ace.jar" />
				<include name="icepush.jar" />
			</lib>
			<lib dir="${ice.lib.dir}/compat">
				<include name="commons-logging.jar" />
				<include name="jxl.jar" />
				<include name="krysalis-jCharts-1.0.0-alpha-1.jar" />
			</lib>
			<lib dir="${ice.lib.dir}/mojarra">
				<include name="javax.faces.jar" />
			</lib>
			<classes dir="${app.build.dir}" />
		</war>
	</target>

</project>

