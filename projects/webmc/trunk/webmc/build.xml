<!--
  ~ Copyright 2004-2012 ICEsoft Technologies Canada Corp.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the
  ~ License. You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an "AS
  ~ IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
  ~ express or implied. See the License for the specific language
  ~ governing permissions and limitations under the License.
  -->

<project name="webmc" default="build.war">

	<!-- The basic build.properties file for customization -->
	<property file="build.properties" />

	<!-- compile settings overridden from -->
	<property name="compile.source" value="1.5" />
	<property name="compile.target" value="1.5" />
	<property name="compile.debug" value="true" />

	<!-- path to applicaiton libraries -->
	<property name="proj.lib.dir" location="lib/" />
	<property name="ice.lib.dir" location="../../icefaces/trunk/icefaces/lib/" />

	<property name="app.build.dir" location="build" />
	<property name="app.dist.dir" location="dist" />

	<patternset id="additional.compile.lib.jars" includes="servlet-api.jar " />

	<!-- jars needed for form validation -->
	<patternset id="validation.jars" includes="
        commons-validator-1.2.0.jar
        oro-gump-28042006.jar
        " />
	<!-- jars needed for JavaMail -->
	<patternset id="javaMail.jars" includes="
        dsn.jar
        imap.jar
        mail.jar
        mailapi.jar
        pop3.jar
        smtp.jar
        activation.jar
        " />

	<!-- jars needed for Facelets -->
	<patternset id="facelets.jars" includes="
        krysalis-jCharts-1.0.0-alpha-1.jar
        el-ri.jar
        " />

	<target name="clean">
		<delete quiet="true">
			<fileset dir="${app.build.dir}" includes="*.jar" />
		</delete>
		<delete dir="${app.build.dir}" />
		<delete dir="${app.dist.dir}" />
		<mkdir dir="${app.build.dir}" />
		<mkdir dir="${app.dist.dir}" />
	</target>

	<target name="compile" depends="clean">
		<javac srcdir="src" destdir="${app.build.dir}" includeantruntime="false" debug="on">
			<classpath>
				<fileset dir="${ice.lib.dir}">
					<include name="**/*.jar" />
				</fileset>

				<fileset dir="${proj.lib.dir}">
					<include name="**/*.jar" />
				</fileset>
			</classpath>
		</javac>
		<copy todir="${app.build.dir}">
			<fileset dir="src/main/java" includes="**/*.properties" />
		</copy>

	</target>

	<target name="build.war" depends="compile">
		<war destfile="${app.dist.dir}\webmc.war" webxml="WebContent/WEB-INF/web.xml">
			<fileset dir="WebContent/" />
			<lib dir="${ice.lib.dir}">
				<include name="icefaces.jar" />
				<include name="icefaces-compat.jar" />
				<include name="icefaces-ace.jar" />
				<include name="icepush.jar" />
			</lib>
			<lib dir="${ice.lib.dir}/compat">
				<include name="commons-logging.jar" />
				<include name="jxl.jar" />
				<include name="krysalis-jCharts-1.0.0-alpha-1.jar" />
			</lib>
			<lib dir="${ice.lib.dir}/mojarra">
				<include name="javax.faces.jar" />
			</lib>
			<lib dir="${proj.lib.dir}">
							<include name="jodconverter-core-3.0-beta-4.jar" />
						</lib>
			<classes dir="${app.build.dir}" />
		</war>
	</target>

</project>

