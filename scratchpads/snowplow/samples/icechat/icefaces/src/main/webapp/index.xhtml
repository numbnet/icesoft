<!--
 *
 * Version: MPL 1.1
 *
 * "The contents of this file are subject to the Mozilla Public License
 * Version 1.1 (the "License"); you may not use this file except in
 * compliance with the License. You may obtain a copy of the License at
 * http://www.mozilla.org/MPL/
 *
 * Software distributed under the License is distributed on an "AS IS"
 * basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
 * License for the specific language governing rights and limitations under
 * the License.
 *
 * The Original Code is ICEfaces 1.5 open source software code, released
 * November 5, 2006. The Initial Developer of the Original Code is ICEsoft
 * Technologies Canada, Corp. Portions created by ICEsoft are Copyright (C)
 * 2004-2009 ICEsoft Technologies Canada, Corp. All Rights Reserved.
 *
 * Contributor(s): _____________________.
 *
 *
  -->
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ice="http://icefaces.org/core"
	xmlns:ui="http://java.sun.com/jsf/facelets">
<h:head>
	<title>ICEpush ICEchat (ICEFaces 2.0)</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
	<h:outputScript name="jsf.js" library="javax.faces" />
	<link rel='stylesheet' type='text/css' href='./css/style-common.css' />
</h:head>
<h:body>
	<h:form>
	<div class="header_container" id="headerContainer">
		<div class="header_content" id="headerContent">
			<div style="font-size: 20pt; color: #0F65B8; margin-top: 15px;">
				<img src="./img/ICEpush-ICEfaces.png" title="ICEpush with ICEfaces"/>
			</div>
		</div>
	</div>

	<div class="body_container body_container_pos" id="bodyContainer">

	<h:panelGroup id="chatPanel"
		rendered="#{not empty loginController.currentUser}">

		<div class="chatSession chatSession_pos" id="chatSession">
		                You are logged in as #{loginController.currentUser.userName}
		                <h:outputText
				rendered="#{not empty loginController.currentUser.nickName}"
				value="(#{loginController.currentUser.nickName})" />&amp;nbsp;
		                <h:commandButton value="Logout"
				actionListener="#{loginController.logout}" />
		</div>

		<div class="clearer" id="clearer" />

		<div class="chatRooms chatRooms_pos" id="chatRoomPanel">
		<h3>Chat Rooms</h3>
		
			<div id="chatRoomList"><ui:repeat
				value="#{chatService.chatRooms}" var="room">
				<div><h:commandLink value="#{room.name}"
					actionListener="#{chatManagerVC.openChatSession(room.name)}" /></div>
			</ui:repeat></div>
			<div class="createNewChatRoom">Create New Chat Room <br />
			<h:outputLabel for="newChatRoomName" value="Name" />&amp;nbsp; <h:inputText
				id="newChatRoomName" value="#{chatManagerVC.newChatRoomName}"
				required="true" style="width: 100px;margin-top:5px;" /> <h:commandButton
				value="Create" style="margin-top:5px;"
				actionListener="#{chatManagerVC.createNewChatRoom}" /></div>
		</div>

		<h:panelGroup rendered="#{not empty chatManagerVC.session}">
			<div class="chatRoomView" id="chatRoomViewPanel">
				<div class="chatRoomHeader">Chat Room
				'#{chatManagerVC.session.room.name}'</div>
				<div class="chatRoomContainer" id="chatRoomContainerPanel">
				<div class="chatRoomUsers" id="chatRoomUsers">
				<div class="chatViewSubHeader">Who's Here?</div>
				<ui:repeat value="#{chatManagerVC.session.room.userChatSessions}"
					var="chatSession">
					<div>#{chatSession.user.displayName}</div>
				</ui:repeat></div>
				<div class="chatRoomMessages" id="chatRoomMessagesPanel">
				<div class="chatViewSubHeader">Messages</div>
				<div id="chatRoomMessagesList"><ui:repeat
					value="#{chatManagerVC.session.room.messages}" var="msg">
					<div><h:outputText value="#{msg.created}">
						<f:convertDateTime type="both" dateStyle="short" timeStyle="short" />
					</h:outputText> &amp;nbsp;#{msg.userChatSession.user.displayName} said
					&amp;nbsp;'#{msg.message}'</div>
				</ui:repeat></div>
				</div>
				</div>
				<div class="clearer" />
				<div class="addNewMessage">New Message&amp;nbsp;<h:inputText
					value="#{chatManagerVC.newChatRoomMessage}" style="width:40%;" />
				<h:commandButton value="Send"
					actionListener="#{chatManagerVC.sendNewMessage}" /></div>
			</div>
		</h:panelGroup>

	</h:panelGroup> <h:panelGroup rendered="#{empty loginController.currentUser}">
		<div class="login">
			<h2>ICEchat Login</h2>
			<div style="text-align: right;"><h:outputLabel
				value="User Name " for="userName" /> <h:inputText id="userName"
				value="#{loginController.credentialsBean.userName}" required="true" />
			</div>
			<div style="text-align: right;"><h:outputLabel
				value="Nick Name " for="nickName" /> <h:inputText id="nickName"
				value="#{loginController.credentialsBean.nickName}" /></div>
			<div style="text-align: right;"><h:outputLabel
				value="Password " for="password" /> <h:inputSecret id="password"
				value="#{loginController.credentialsBean.password}" required="true" />
			</div>
			<div style="text-align: right; margin-top: 20px;"><h:commandButton
				id="login" value="Login" actionListener="#{loginController.login}" />
			<h:commandButton id="register" value="Register"
				actionListener="#{loginController.register}" /></div>
			<div id="loginMessages"><h:messages globalOnly="true" /></div>

		</div>
	</h:panelGroup></div>
	</h:form>
</h:body>
</html>

