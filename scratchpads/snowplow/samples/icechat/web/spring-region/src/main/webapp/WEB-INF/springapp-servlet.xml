<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <bean id="pushRequestManager" class="org.icepush.samples.icechat.spring.mvc.PushRequestManager" scope="session">
    </bean>

    <bean id="loginFormData" class="org.icepush.samples.icechat.spring.mvc.LoginFormData" scope="session">
    </bean>

    <bean id="chatService" class="org.icepush.samples.icechat.spring.impl.BaseChatService" scope="singleton">
    </bean>    

    <bean id="loginController" class="org.icepush.samples.icechat.spring.impl.BaseLoginController" scope="session">
        <property name="credentialsBean" ref="loginFormData"/>
        <property name="chatService" ref="chatService"/>
    </bean>

    <bean id="chatManagerFacade" class="org.icepush.samples.icechat.spring.impl.BaseChatManagerFacade" scope="singleton">
        <property name="chatService" ref="chatService"/>
    </bean>

    <bean id="currentChatSessionHolder" class="org.icepush.samples.icechat.spring.impl.BaseCurrentChatSessionHolder" scope="session">
    </bean>

    <bean id="chatManagerViewController" class="org.icepush.samples.icechat.spring.impl.BaseChatManagerViewController" scope="session">
        <property name="loginController" ref="loginController"/>
        <property name="chatService" ref="chatService"/>
        <property name="currentChatSessionHolder" ref="currentChatSessionHolder"/>
    </bean>    

    <bean id="chatFormData" class="org.icepush.samples.icechat.spring.mvc.ChatFormData" scope="session">
        <property name="chatManagerViewController" ref="chatManagerViewController"/>
        <property name="currentChatSessionHolder" ref="currentChatSessionHolder"/>
    </bean>

    <bean name="/login.htm" class="org.icepush.samples.icechat.spring.mvc.LoginFormController" scope="session">
        <property name="pushRequestManager" ref="pushRequestManager"/>
        <property name="loginFormData" ref="loginFormData"/>
        <property name="baseLoginController" ref="loginController"/>
        <property name="sessionForm" value="true"/>
        <property name="commandName" value="login"/>
        <property name="validator">
            <bean class="org.icepush.samples.icechat.spring.mvc.LoginFormValidator"/>
        </property>        
        <property name="successView" value="talk.htm"/>
    </bean>

    <bean name="/logout.htm" class="org.icepush.samples.icechat.spring.mvc.LogoutFormController" scope="session">
        <property name="baseLoginController" ref="loginController"/>
    </bean>

    <bean name="/talk.htm" class="org.icepush.samples.icechat.spring.mvc.ChatFormController" scope="session">
        <property name="pushRequestManager" ref="pushRequestManager"/>
        <property name="chatFormData" ref="chatFormData"/>
        <property name="loginController" ref="loginController"/>
        <property name="chatManagerFacade" ref="chatManagerFacade"/>
        <property name="sessionForm" value="true"/>
        <property name="commandName" value="chat"/>
    </bean>

    <bean name="/messages.htm" class="org.icepush.samples.icechat.spring.mvc.MessagesFormController" scope="session">
        <property name="chatFormData" ref="chatFormData"/>
    </bean>

    <bean name="/users.htm" class="org.icepush.samples.icechat.spring.mvc.UsersFormController" scope="session">
        <property name="chatFormData" ref="chatFormData"/>
    </bean>

    <bean id="messageSource" class="org.springframework.context.support.ResourceBundleMessageSource">
        <property name="basename" value="messages"/>
    </bean>

    <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
        <property name="prefix" value="/WEB-INF/jsp/"/>
        <property name="suffix" value=".jsp"/>
    </bean>

</beans>
