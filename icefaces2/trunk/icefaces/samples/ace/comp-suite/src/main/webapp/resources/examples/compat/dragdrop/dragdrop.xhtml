<?xml version="1.0"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:h="http://java.sun.com/jsf/html" 
    xmlns:f="http://java.sun.com/jsf/core" 
    xmlns:c="http://java.sun.com/jsp/jstl/core" 
    xmlns:ace="http://www.icefaces.org/icefaces/components" 
    xmlns:ice="http://www.icesoft.com/icefaces/component" 
    xmlns:ui="http://java.sun.com/jsf/facelets" 
    template="/resources/templates/content-template.xhtml">
    
    <ui:param name="title" value="#{msgs[dragdrop.title]}"/>
    <ui:param name="description" value="#{msgs[dragdrop.description]}"/>
    <ui:param name="resourceValue" value="#{dragdrop.exampleResource}"/>
    
    <ui:define name="example">
        <p><b>Demo Use Cases:</b></p>
        <p><b>1.</b> Click and drag an item from the top list into the white shopping cart area below. This will populate the data table of current items, which simulates a user purchasing something from an online store.</p>
        <p><b>2.</b> Click the "Return" button on an item to move it back into the "store" stock.</p>
        <p>Drag and drop functionality is very useful for unique use cases in rich web applications. Instead of traditional web methods of add/remove buttons, drag and drop can be used instead.</p>
        <p>Implementing drag and drop is simple for a developer as they can customize what happens during the drag and drop by using provided listeners.</p>
        <p>Coupling drag and drop with the effect component is an elegant way to help users understand what is going on, as shown here with the orange highlight when an item is hovered over the cart.</p> 
        <br/>
    
        <h:form>
            <ice:panelSeries value="#{dragdropData.items}"
                             var="item">
                 <h:panelGroup styleClass="dragContainer"
                               style="margin: 5px;">
                    <ice:panelGroup draggable="true"
                                    dragValue="#{item.id}"
                                    dragMask="dragging,drag_cancel,hover_start,dropped,hover_end"
                                    dropMask="dragging,drag_cancel,hover_start,dropped,hover_end"
                                    dragOptions="revert"
                                    style="z-index: 1004;"
                                    rendered="#{!item.outOfStock}">
                        <h:graphicImage library="css/images/dragdrop"
                                        name="#{item.image}"
                                        alt="#{item.name}"
                                        style="z-index: 1005;"
                                        width="119px" height="76px"/>
                    </ice:panelGroup>
                    <h:panelGroup rendered="#{item.outOfStock}">
                        <h:graphicImage library="css/images/dragdrop"
                                        name="sold-out.png"
                                        alt="Sold Out"
                                        title="Item #{item.name} is Sold Out"
                                        width="119px" height="76px"/>
                    </h:panelGroup>
                    <h:panelGrid columns="2">
                        <h:outputLabel for="nameOut" value="Name:"/>
                        <h:outputText id="nameOut" value="#{item.name}"/>
                        
                        <h:outputLabel for="priceOut" value="Price:"/>
                        <h:outputText id="priceOut" value="#{item.price}">
                            <f:convertNumber type="currency"
                                             currencySymbol="$"
                                             groupingUsed="true"
                                             minFractionDigits="2"
                                             maxFractionDigits="2"/>
                        </h:outputText>
                        
                        <h:outputLabel for="quantOut" value="Quantity:"/>
                        <h:outputText id="quantOut" value="#{item.quantity}"
                                      style="color: #{item.outOfStock ? 'red' : 'white'};"/>
                    </h:panelGrid>
                 </h:panelGroup>
            </ice:panelSeries>
            
            <br/>
            
            <ice:dataTable value="#{dragdrop.purchased}"
                           var="item"
                           width="100%">
                <f:facet name="header">
                    <ice:panelGroup dropTarget="true"
                                    dragMask="dragging,drag_cancel,hover_end"
                                    dropMask="dragging,drag_cancel,hover_end"
                                    dropListener="#{dragdrop.dropListener}"
                                    effect="#{dragdrop.dropEffect}"
                                    styleClass="dropContainer">
                        <h:graphicImage library="css/images/dragdrop"
                                        name="shopping-cart.png"
                                        style="padding-top: 22px;"/>
                    </ice:panelGroup>
                </f:facet>
                <ice:column>
                    <f:facet name="header">
                        ID
                    </f:facet>
                    #{item.id}
                </ice:column>
                <ice:column>
                    <f:facet name="header">
                        Name
                    </f:facet>
                    #{item.name}
                </ice:column>
                <ice:column>
                    <f:facet name="header">
                        Unit Price
                    </f:facet>
                    <h:outputText value="#{item.price}">
                        <f:convertNumber type="currency"
                                         currencySymbol="$"
                                         groupingUsed="true"
                                         minFractionDigits="2"
                                         maxFractionDigits="2"/>
                    </h:outputText>
                </ice:column>
                <ice:column>
                    <f:facet name="header">
                        Quantity
                    </f:facet>
                    #{item.quantity}
                </ice:column>
                <ice:column>
                    <f:facet name="header">
                        Manage
                    </f:facet>
                    <h:commandButton value="Return"
                                     immediate="true"
                                     action="#{dragdrop.returnItemAction}">
                         <f:setPropertyActionListener target="#{dragdrop.toReturn}"
                                                      value="#{item.id}"/>
                    </h:commandButton>
                </ice:column>
                <f:facet name="footer">
                    <h:panelGrid columns="3"
                                 columnClasses="col25,col75,colRight">
                        <h:outputLabel for="totalOut" value="Total Cart Price:"/>
                        <h:outputText id="totalOut" value="#{dragdrop.totalPrice}">
                            <f:convertNumber type="currency"
                                             currencySymbol="$"
                                             groupingUsed="true"
                                             minFractionDigits="2"
                                             maxFractionDigits="2"/>
                        </h:outputText>
                        <h:commandButton value="Return All"
                                         actionListener="#{dragdrop.returnAll}"
                                         disabled="#{!dragdrop.hasPurchased}"/>
                    </h:panelGrid>
                </f:facet>
            </ice:dataTable>
        </h:form>
    </ui:define>
</ui:composition>
