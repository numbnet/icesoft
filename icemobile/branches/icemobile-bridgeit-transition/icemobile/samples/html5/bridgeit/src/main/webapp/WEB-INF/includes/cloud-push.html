<div id="cloudpush" title="Notify It" class="panel">
    <h2>Device Notifications</h2>
    <fieldset>
        <div class="row"><p class="normalText">Cloud notifications with ICEpush...</p></div>
        <div class="row">
            <code>
                ice.push.notify(group,<br/>
                &nbsp;&nbsp;{subject:'subject', detail:'detail'});
            </code>
        </div>
    </fieldset>

    <a id="regBtn" type="button" class="whiteButton bridgeItBtn"
        onclick="bridgeit.register('_reg');">Enable Cloud Push</a>

    <a id="pushBtn" type="button" class="whiteButton bridgeItBtn"
        onclick="notifyLater();">Notify upon exit</a>

    <fieldset>
        <div class="row"></div>
    </fieldset>
    <fieldset id="notifications">
    </fieldset>
    <div class="footer">
        <a href="#">
            <img src="./images/icesoft-emblem.png" class="icesoft-emblem"/>
        </a>
        &copy; 2013 ICEsoft Technologies
    </div>
    <script type="text/javascript" src="http://labs.icesoft.com/push/code.icepush"></script>
    <script type="text/javascript">

    function handleNotification(event)  {
        alert(event);
    }

    //this can be simplified now that ICEpush configuration
    //is improved
    ice.push.configuration.contextPath =
            "http://labs.icesoft.com/push/";
    ice.push.configuration.blockingConnectionURI =
            "http://labs.icesoft.com/push/listen.icepush";
    ice.push.configuration.createPushIdURI =
            "http://labs.icesoft.com/push/create-push-id.icepush";
    ice.push.configuration.notifyURI =
            "http://labs.icesoft.com/push/notify.icepush";
    ice.push.configuration.addGroupMemberURI =
            "http://labs.icesoft.com/push/add-group-member.icepush";
    ice.push.configuration.removeGroupMemberURI =
            "http://labs.icesoft.com/push/remove-group-member.icepush";

    //change to a uniquely generated pushID once initial testing is complete
    var pagePushId = ice.push.createPushId();
    ice.push.addGroupMember("bridgeit", pagePushId);
    ice.push.register([pagePushId], function(pushIds) {
        console.log("notified");
        alert("You have been notified.");
    });

    var notifyReady = false;
    function notifyLater()  {
        notifyReady = true;
    }

    window.addEventListener("pagehide", function () {
        ice.push.connection.pauseConnection();
        if (notifyReady)  {
            notifyReady = false;
            ice.push.notify( 'bridgeit',
                {subject:'BridgeIt Cloud Push',
                detail:'You have been notified.'} );
        }
    }, false);

    </script>
   
</div>
