<?xml version="1.0"?>

<project name="dataTable-tomcat6" default="noejb.archive" basedir=".">

    <!-- Give user a chance to override without editing this file or typing -D -->
    <property file="${basedir}/build.properties" />
    
    <!-- set global properties for this build -->
    <property name="project.name" value="dataTable"/>

    <property name="lib.dir" value="lib" />
    <property name="dist.dir" value="dist-tomcat6" />
    <property name="exploded-archives.dir" value="exploded-archives-tomcat6" />
    <property name="war.dir" value="${exploded-archives.dir}/${project.name}.war" />
    <property name="classes.model.dir" value="${war.dir}/WEB-INF/classes" />
    <property name="action.dir" value="WEB-INF/classes" />
    <property name="classes.action.dir" value="${war.dir}/${action.dir}" />
    <property name="javac.debug" value="true" />
    <property name="javac.deprecation" value="false" />
    <property name="src.action.dir" value="src" />

	<target name="freshen"  description="grab fresh icefaces jars">
		<copy todir="${lib.dir}">
	        <fileset dir="${icefaces.home}/lib">
	              <include name="backport-util-concurrent.jar" />	
		      <include name="commons-beanutils.jar"/>
		      <include name="commons-collections.jar"/>
		      <include name="commons-digester.jar"/>
		      <include name="commons-discovery.jar"/>
		      <include name="commons-el.jar"/>
		      <include name="commons-fileupload.jar"/> 
	              <include name="commons-logging*.jar"/>
                      <include name="icefaces-comps.jar" />
                      <include name="icefaces.jar" />
		     
		     <include name="commons-lang.jar" />
		      <include name="jsf-api-1.2.jar" />
		      <include name="jsf-impl-1.2.jar" />		     
		      <include name="jstl.jar" />
	       </fileset>
	   </copy>	    
	</target>

    <fileset id="lib" dir="${lib.dir}">
        <include name="*.jar" />
    </fileset>
    
    <path id="build.classpath">
        <fileset refid="lib" />
    </path>

	
	<target name="noejb.archive" depends="war" description="package war for distribution">
	     <jar jarfile="${dist.dir}/${project.name}.war" basedir="${war.dir}"/>
	</target>

    <target name="init" description="Initialize the build">
        <mkdir dir="${classes.model.dir}" />
        <mkdir dir="${classes.action.dir}" />
        <mkdir dir="${dist.dir}" />
    	<mkdir dir="${war.dir}"/>
    </target>  
   
    <target name="compileactions" depends="init"
            description="Compile the Java source code" >
        <javac classpathref="build.classpath" 
               destdir="${classes.action.dir}"
               debug="${javac.debug}" 
               deprecation="${javac.deprecation}" 
               nowarn="on">
            <classpath path="${classes.model.dir}"/>
            <src path="${src.action.dir}" />
        </javac>
    </target>

    <target name="war" depends="compileactions" 
            description="Build the distribution .war file">
   		<echo message=" war building ....get Persistence"/>
       <copy todir="${war.dir}/WEB-INF/classes">
    	   <fileset dir="${src.action.dir}">
        	    <include name="META-INF/*.*"/>
    	   	    <exclude name="META-INF/context.xml"/>
        	</fileset>
    	</copy>         

        <copy todir="${war.dir}">
            <fileset dir="${basedir}/web" />
        </copy>

	     <copy todir="${war.dir}/WEB-INF/lib">
		<fileset refid="lib" />
	    </copy>
        
        <!-- resources for the jar part of the war -->
    	<echo message="copying noejb.war.extras"/>
    	<copy todir="${war.dir}">
	    <fileset dir="${src.action.dir}">
		<include name="META-INF/context.xml" />
	    </fileset>
        </copy>
    	
    </target>

</project>