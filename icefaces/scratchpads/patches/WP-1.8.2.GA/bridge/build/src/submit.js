function currentConnection(){var A=$enumerate(arguments).detect(function(B){return !!B;});return A.findConnection();}function formOf(A){var B=A.parentNode;while(B){if(B.tagName&&B.tagName.toLowerCase()=="form"){return B;}B=B.parentNode;}throw"Cannot find enclosing form.";}function iceSubmitPartial(C,B,A,D){C=(C?C:B.form);if(!D){D=new Ice.Parameter.Query();}if(Ice.InputFileIdPreUpload){D.add("ice.inputFile.preUpload",Ice.InputFileIdPreUpload);}if(Ice.InputFileIdPostUpload){D.add("ice.inputFile.postUpload",Ice.InputFileIdPostUpload);}if(Ice.Menu!=null&&Ice.Menu.menuContext!=null){D.add("ice.menuContext",Ice.Menu.menuContext);}if(Ice.FCKeditorUtility){Ice.FCKeditorUtility.saveAll();}D.add("ice.submit.partial",true);$event(A,B).serializeOn(D);if(C&&C.id){$element(C).serializeOn(D);}if(B&&B.id){var E=$element(B);if(E.isSubmit()){E.serializeOn(D);}}D.sendOn(currentConnection($element(C),$element(B)));resetHiddenFieldsFor(C);return false;}function iceSubmit(B,D,A,H){B=(B?B:D.form);var F=$event(A,D);var E=$element(B);if(!H){H=new Ice.Parameter.Query();}if(Ice.InputFileIdPreUpload){H.add("ice.inputFile.preUpload",Ice.InputFileIdPreUpload);}if(Ice.InputFileIdPostUpload){H.add("ice.inputFile.postUpload",Ice.InputFileIdPostUpload);}if(Ice.Menu!=null&&Ice.Menu.menuContext!=null){H.add("ice.menuContext",Ice.Menu.menuContext);}if(Ice.FCKeditorUtility){Ice.FCKeditorUtility.saveAll();}H.add("ice.submit.partial",false);if(F.isKeyEvent()){if(F.isEnterKey()){var G=E?E.detectDefaultSubmit():null;F.cancelDefaultAction();F.serializeOn(H);if(G){G.serializeOn(H);}if(E){E.serializeOn(H);}H.sendOn(currentConnection($element(B),$element(D)));}}else{var C=D&&D.id?$element(D):null;F.serializeOn(H);if(C&&C.isSubmit()){C.serializeOn(H);}if(E){E.serializeOn(H);}H.sendOn(currentConnection($element(B),$element(D)));}resetHiddenFieldsFor(B);return false;}function resetHiddenFieldsFor(A){$enumerate(A.elements).each(function(B){if(B.type=="hidden"&&B.id==""){B.value="";}});}