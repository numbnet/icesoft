Ice.Resizable=Class.create({initialize:function(B,A){this.source=Event.element(B);this.horizontal=A;if(this.horizontal){this.pointerLocation=parseInt(Event.pointerY(B));}else{this.pointerLocation=parseInt(Event.pointerX(B));}this.eventMouseMove=this.resize.bindAsEventListener(this);this.eventMouseUp=this.detachEvent.bindAsEventListener(this);Event.observe(document,"mousemove",this.eventMouseMove);Event.observe(document,"mouseup",this.eventMouseUp);this.origionalHeight=this.source.style.height;this.disableTextSelection();this.getGhost().style.position="absolute";this.deadPoint=20;},print:function(A){logger.info(A);},getPreviousElement:function(){},getContainerElement:function(){},getNextElement:function(){},getGhost:function(){return this.source;},finalize:function(A){this.source.style.position="";this.source.style.left=Event.pointerX(A)+"px";},resize:function(A){this.getGhost().style.visibility="";if(this.deadEnd(A)){return ;}if(this.horizontal){this.getGhost().style.cursor="n-resize";var C=Event.pointerY(A)-this.getGhost().getOffsetParent().cumulativeOffset().top;this.getGhost().style.top=C+"px";}else{this.getGhost().style.cursor="e-resize";var B=Event.pointerX(A)-this.getGhost().getOffsetParent().cumulativeOffset().left;this.getGhost().style.left=B+"px";}},detachEvent:function(A){this.source.style.height=this.origionalHeight;if(this.getDifference(A)>0&&!this.deadEnd(A)){this.adjustPosition(A);}Event.stopObserving(document,"mousemove",this.eventMouseMove);Event.stopObserving(document,"mouseup",this.eventMouseUp);this.enableTextSelection();this.finalize(A);},adjustPosition:function(C){var E=Element.getWidth(this.getPreviousElement());var B=Element.getWidth(this.getNextElement());var A=Element.getWidth(this.getContainerElement());var D=this.getDifference(C);if(this.resizeAction=="inc"){this.getPreviousElement().style.width=(E+D)+"px";this.getNextElement().style.width=(B-D)+"px";this.print("Diff "+D);this.print("Td width "+E+this.getPreviousElement().id);this.print("Table width "+A);}else{this.getPreviousElement().style.width=(E-D)+"px";this.getNextElement().style.width=(B+D)+"px";}},getDifference:function(B){var A;if(this.horizontal){A=parseInt(Event.pointerY(B));}else{A=parseInt(Event.pointerX(B));}if(this.pointerLocation>A){this.resizeAction="dec";return this.pointerLocation-A;}else{this.resizeAction="inc";return A-this.pointerLocation;}},deadEnd:function(B){var C=this.getDifference(B);if(this.resizeAction=="dec"){var D;if(this.horizontal){D=Element.getHeight(this.getPreviousElement());}else{D=Element.getWidth(this.getPreviousElement());}if((D-C)<this.deadPoint){return true;}}else{var A;if(this.horizontal){A=Element.getHeight(this.getNextElement());}else{A=Element.getWidth(this.getNextElement());}if((A-C)<this.deadPoint){return true;}}return false;},disableTextSelection:function(){this.getContainerElement().onselectstart=function(){return false;};this.source.style.unselectable="on";this.source.style.MozUserSelect="none";this.source.style.KhtmlUserSelect="none";},enableTextSelection:function(){this.getContainerElement().onselectstart=function(){return true;};this.source.style.unselectable="";this.source.style.MozUserSelect="";this.source.style.KhtmlUserSelect="";}});Ice.ResizableGrid=Class.create(Ice.Resizable,{initialize:function($super,A){$super(A);logger.info(">>>>>>>>>>>>>>>>>>> ");this.cntHght=(Element.getHeight(this.getContainerElement()))+"px";this.source.style.height=this.cntHght;this.getGhost().style.left=Event.pointerX(A)+"px";this.source.style.backgroundColor="#CCCCCC";}});Ice.ResizableGrid.addMethods({getDifference:function($super,A){return $super(A);},getContainerElement:function(){return this.source.parentNode.parentNode.parentNode.parentNode;},getPreviousElement:function(){if(this.source.parentNode.previousSibling.tagName=="TH"){return this.source.parentNode.previousSibling.firstChild;}else{return this.source.parentNode.previousSibling.previousSibling.firstChild;}},getNextElement:function(){if(this.source.parentNode.nextSibling.tagName=="TH"){return this.source.parentNode.nextSibling.firstChild;}else{return this.source.parentNode.nextSibling.nextSibling.firstChild;}},resize:function($super,A){this.source.style.height=this.cntHght;this.getGhost().style.height=this.cntHght;$super(A);this.source.style.height=this.cntHght;this.getGhost().style.height=this.cntHght;},finalize:function($super,C){$super(C);this.source.style.height="1px";this.source.style.backgroundColor="transparent";this.getGhost().style.height="1px";var A=$(this.getContainerElement().id+"clientOnly");if(A){A.value=this.getAllColumnsWidth();var B=Ice.util.findForm(A);iceSubmitPartial(B,A,C);}},getAllColumnsWidth:function(){var A=this.getContainerElement();var B=A.firstChild.firstChild.childNodes;var D=2;if(Prototype.Browser.Gecko){D+=2;}var C="";for(i=0;i<B.length;i++){if(i%D==0){C+=Element.getStyle(B[i].firstChild,"width")+",";}}return C;}});Ice.PanelDivider=Class.create(Ice.Resizable,{initialize:function($super,A,B){$super(A,B);this.deadPoint=20;if(this.horizontal){var H=Element.getHeight(this.source);var G=Event.pointerY(A);this.getGhost().style.top=(G-(H))+"px";this.getGhost().style.width=(Element.getWidth(this.getContainerElement()))+"px";}else{var C=Element.getWidth(this.source);var D=parseInt(Element.getStyle(this.source,"border-left-width"));var E=parseInt(Element.getStyle(this.source,"border-right-width"));if(D&&D>=1){C-=D;}if(E&&E>=1){C-=E;}var F=Event.pointerX(A);this.getGhost().style.left=(F-(C))+"px";this.getGhost().style.width=C+"px";this.getGhost().style.height=(Element.getHeight(this.getContainerElement()))+"px";}}});Ice.PanelDivider.addMethods({getDifference:function($super,A){return $super(A);},getContainerElement:function(){return this.source.parentNode.parentNode;},getPreviousElement:function(){if(this.source.previousSibling.tagName=="DIV"){return this.source.previousSibling;}else{return this.source.previousSibling.previousSibling;}},getNextElement:function(){if(this.source.nextSibling.tagName=="DIV"){return this.source.nextSibling;}else{return this.source.nextSibling.nextSibling;}},getGhost:function(){if(!this.ghost){this.ghost=this.source.cloneNode(true);this.ghost.id=this.source.id+":ghost";this.ghost.onmousedown=null;this.source.parentNode.appendChild(this.ghost);this.ghost.style.width=Element.getWidth(this.source)+"px";this.getGhost().style.visibility="hidden";}this.ghost.setStyle({width:this.source.getStyle("width")});return this.ghost;},finalize:function(A){Element.remove(this.ghost);},adjustPosition:function(A){logger.info("<<<<<<<<<<<<<<<<<<<<< ADJUST POSTITITITITITI >>>>>>>>>>>>>>>>");var D=this.getNextElement().style.visibility;this.getNextElement().style.visibility="hidden";if(this.horizontal){var H=(Element.getHeight(this.getPreviousElement()));var C=(Element.getHeight(this.getNextElement()));var B=Element.getHeight(this.getContainerElement());var I=(parseInt(H)+parseInt(C));var J=this.getDifference(A);var M;if(this.resizeAction=="inc"){M=(H+J)/B;topInPercent=Math.round(M*100);bottomInPercent=99-topInPercent;this.getPreviousElement().style.height=(topInPercent)+"%";}else{M=(H-J)/B;topInPercent=Math.round(M*100);bottomInPercent=99-topInPercent;this.getPreviousElement().style.height=(topInPercent)+"%";}}else{var L=(Element.getWidth(this.getPreviousElement()));var G=(Element.getWidth(this.getNextElement()));var K=(Element.getWidth(this.source));var F=Element.getWidth(this.getContainerElement());var E=(parseInt(L)+parseInt(G));var J=this.getDifference(A);if(this.resizeAction=="inc"){M=(L+J)/F;leftInPercent=Math.round(M*100);rightInPercent=100-leftInPercent;this.getPreviousElement().style.width=leftInPercent+"%";}else{M=(L-J)/F;leftInPercent=Math.round(M*100);rightInPercent=100-leftInPercent;this.getPreviousElement().style.width=leftInPercent+"%";}}Ice.PanelDivider.adjustSecondPaneSize(this.source,this.horizontal);this.getNextElement().style.visibility=D;M=M+0.01;this.submitInfo(A,M);},submitInfo:function(D,B){var C=Ice.util.findForm(this.source);var A=this.getContainerElement().id;var F=$(A+"FirstPane");var G=$(A+"SecondPane");var E=$(A+"InPercent");F.value=this.getPreviousElement().style.cssText;G.value=this.getNextElement().style.cssText;E.value=Math.round(B*100);iceSubmitPartial(C,this.source,D);}});Ice.PanelDivider.adjustSecondPaneSize=function(C,E){C=$(C);var B=$(C.parentNode);var A=$(Ice.PanelDivider.prototype.getPreviousElement.call({source:C}));var D=$(Ice.PanelDivider.prototype.getNextElement.call({source:C}));if(E){D.style.height=B.clientHeight-A.offsetHeight-C.offsetHeight+"px";}else{D.style.width=B.clientWidth-A.offsetWidth-C.offsetWidth-1+"px";}};Ice.PanelDivider.dividerHash=$H();Ice.PanelDivider.onWindowResize=function(){Ice.PanelDivider.dividerHash.each(function(A){if(!$(A.key)){Ice.PanelDivider.dividerHash.unset(A.key);return ;}Ice.PanelDivider.adjustSecondPaneSize(A.key,A.value);});};Ice.PanelDivider.onLoad=function(A,B){Event.stopObserving(window,"resize",Ice.PanelDivider.onWindowResize);Ice.PanelDivider.dividerHash.set(A,B);Event.observe(window,"resize",Ice.PanelDivider.onWindowResize);Ice.PanelDivider.adjustSecondPaneSize(A,B);Ice.PanelDivider.adjustPercentBasedHeight(A,B);};ResizableUtil={adjustHeight:function(D){var A=Element.getHeight(D);var B=parseInt(Element.getStyle(D,"padding-top"));var C=parseInt(Element.getStyle(D,"padding-top"));if(B&&B>1){A-=B;}if(C&&C>1){A-=C;}D.firstChild.style.height=(A-1)+"px";}};Ice.PanelDivider.adjustPercentBasedHeight=function(C,F){if(F){return ;}var E=C.replace("Divider","");var A=$(E);var B=Element.getStyle(A,"height");var D=null;if(B&&B.indexOf("%")>0){D=B.split("%")[0];}if(D){parentHeight=Ice.PanelDivider.getParentHeight(A);newVal=Math.round(parentHeight*(D/100));A.style.height=newVal+"px";$(C).style.height=newVal+"px";}};Ice.PanelDivider.getParentHeight=function(B){if(B.tagName=="BODY"){var C=document.viewport.getHeight();if(Prototype.Browser.WebKit&&typeof window.innerHeight!="undefined"){C=window.innerHeight;}return(C-4);}var A=Element.getStyle(B,"height");if(A.indexOf("%")>0){return Ice.PanelDivider.getParentHeight(B.parentNode);}else{A=Element.getHeight(B);if(A=="2"){return Ice.PanelDivider.getParentHeight(B.parentNode);}}return A;};