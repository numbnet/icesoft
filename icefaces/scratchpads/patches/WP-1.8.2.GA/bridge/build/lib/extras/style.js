Ice.DnD.StyleReader=Class.create();Ice.DnD.StyleReader={styles:"position,top,left,display",buildStyle:function(B){var A="";Ice.DnD.StyleReader.styles.split(",").each(function(C){A+=C+":"+Ice.DnD.StyleReader.getStyle(B,C)+";";});return A;},getStyle:function(B,A){if(B.currentStyle){var C=B.currentStyle[A];}else{if(window.getComputedStyle){var C=document.defaultView.getComputedStyle(B,null).getPropertyValue(A);}else{var C=B.style[A];}}return C;},findCssField:function(E,D){if(!D){D=Ice.util.findForm(E);}var B=D.getElementsByTagName("input");var A=null;var C=0;for(C=0;C<B.length;C++){if(B[C].type=="hidden"&&B[C].name=="icefacesCssUpdates"){A=B[C];break;}}return A;},upload:function(E,D){var A=Ice.DnD.StyleReader.findCssField(E);if(A){var F=A.value;var B=Ice.DnD.StyleReader.buildStyle(E);Ice.DnD.logger.debug("Update CSS ID["+E.id+"] CSS["+B+"] form filed name = ["+A.name+"]");A.value=F+E.id+"{"+B+"}";if(D){var C=Ice.util.findForm(E);iceSubmitPartial(C,E,null);}}}};Ice.modal=Class.create();Ice.modal={running:false,target:null,ids:[],tabindexValues:[],zIndexCount:25000,start:function(F,C,B,H){var E=document.getElementById(F);E.style.visibility="hidden";E.style.position="absolute";var D=document.getElementById("iceModalFrame"+F);if(!D){D=document.createElement("iframe");D.title="Ice Modal Frame";D.frameborder="0";D.id="iceModalFrame"+F;D.src=C;D.style.zIndex=Ice.modal.zIndexCount;Ice.modal.zIndexCount+=3;D.style.opacity=0.5;D.style.filter="alpha(opacity=50)";D.style.position="absolute";D.style.visibility="hidden";D.style.backgroundColor="black";D.style.borderWidth="0";D.style.top="0";D.style.left="0";E.parentNode.insertBefore(D,E);var G=document.createElement("div");G.style.position="absolute";G.style.zIndex=parseInt(D.style.zIndex)+1;G.style.backgroundColor="transparent";E.parentNode.insertBefore(G,E);var A=function(){var J=document.getElementById("iceModalFrame"+F);if(J){var K=J.style.display;J.style.display="none";var Q=document.documentElement.scrollWidth;var P=document.body.scrollWidth;var T=document.documentElement.scrollHeight;var S=document.body.scrollHeight;var I=(P>Q?P:Q);var R=(S>T?S:T);var M=document.viewport.getHeight();if(R<M){R=M;}J.style.width=I+"px";J.style.height=R+"px";J.style.visibility="visible";var N=100;var L=100;try{N=Element.getWidth(E);L=Element.getHeight(E);}catch(O){}N=parseInt(N)/2;L=parseInt(L)/2;if(!H){E.style.top=(parseInt(R)/2)-L+"px";E.style.left=(parseInt(I)/2)-N+"px";}J.style.display=K;$(J.nextSibling).clonePosition(J);}};A();window.onResize(A);window.onScroll(A);}var E=document.getElementById(F);E.style.zIndex=parseInt(D.style.zIndex)+2;Ice.modal.target=E;Ice.modal.ids.push(F);if(!Ice.modal.running){Ice.modal.disableTabindex();}Ice.modal.running=true;E.style.visibility="visible";if(B){Ice.modal.trigger=B;$(B).blur();setFocus("");}},stop:function(B){if(Ice.modal.ids.last()==B){var A=document.getElementById("iceModalFrame"+B);if(A){A.parentNode.removeChild(A.nextSibling);A.parentNode.removeChild(A);logger.debug("removed modal iframe for : "+B);}Ice.modal.ids.pop();Ice.modal.zIndexCount-=3;Ice.modal.running=false;if(Ice.modal.trigger){Ice.Focus.setFocus(Ice.modal.trigger);Ice.modal.trigger="";}Ice.modal.restoreTabindex();}},disableTabindex:function(){var F={};F.a=document.getElementsByTagName("a");F.area=document.getElementsByTagName("area");F.button=document.getElementsByTagName("button");F.input=document.getElementsByTagName("input");F.object=document.getElementsByTagName("object");F.select=document.getElementsByTagName("select");F.textarea=document.getElementsByTagName("textarea");var A=[];for(listName in F){var D=F[listName];for(var B=0;B<D.length;B++){var C=D[B];if(!Ice.modal.containedInId(C,Ice.modal.ids.last())){var E={};E.element=C;E.tabIndex=C.tabIndex?C.tabIndex:"";C.tabIndex="-1";A.push(E);}}}Ice.modal.tabindexValues=A;},restoreTabindex:function(){Ice.modal.tabindexValues.each(function(A){A.element.tabIndex=A.tabIndex;});Ice.modal.tabindexValues=[];},containedInId:function(B,C){if(B.id==C){return true;}var A=B.parentNode;if(A){return Ice.modal.containedInId(A,C);}return false;}};Ice.autoCentre=Class.create();Ice.autoCentre={ids:[],centerAll:function(){Ice.autoCentre.ids.each(Ice.autoCentre.keepCentred);},keepCentred:function(F){var C=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft;var B=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;var E=document.getElementById(F);if(E){var A=Math.round((Element.getWidth(document.body)-Element.getWidth(E))/2+C);if(A<0){A=0;}var D=Math.round(((window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)-Element.getHeight(E))/2+B);if(D<0){D=0;}A=A+"px";D=D+"px";Element.setStyle(E,{position:"absolute"});Element.setStyle(E,{left:A});Element.setStyle(E,{top:D});}},start:function(A){Ice.autoCentre.keepCentred(A);if(Ice.autoCentre.ids.size()==0){Event.observe(window,"resize",Ice.autoCentre.centerAll);Event.observe(window,"scroll",Ice.autoCentre.centerAll);}if(Ice.autoCentre.ids.indexOf(A)<0){Ice.autoCentre.ids.push(A);}},stop:function(A){Ice.autoCentre.ids=Ice.autoCentre.ids.without(A);if(Ice.autoCentre.ids.size()==0){Event.stopObserving(window,"resize",Ice.autoCentre.centerAll);Event.stopObserving(window,"scroll",Ice.autoCentre.centerAll);}}};Ice.autoPosition=Class.create();Ice.autoPosition={id:null,xPos:null,yPos:null,keepPositioned:function(){var C=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft;var B=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;var E=document.getElementById(Ice.autoPosition.id);if(E){var A=Math.round(Ice.autoPosition.xPos+C)+"px";var D=Math.round(Ice.autoPosition.yPos+B)+"px";Element.setStyle(E,{position:"absolute"});Element.setStyle(E,{left:A});Element.setStyle(E,{top:D});}},start:function(C,A,D){Ice.autoPosition.id=C;Ice.autoPosition.xPos=A;Ice.autoPosition.yPos=D;var B=document.getElementById(C).style;if(!Prototype.Browser.IE){B.visibility="hidden";}Ice.autoPosition.keepPositioned();if(!Prototype.Browser.IE){B.visibility="visible";}Event.observe(window,"scroll",Ice.autoPosition.keepPositioned);},stop:function(A){if(Ice.autoPosition.id==A){Event.stopObserving(window,"scroll",Ice.autoPosition.keepPositioned);}}};Ice.iFrameFix=Class.create();Ice.iFrameFix={start:function(B,D){var C=navigator.userAgent.indexOf("MSIE");if(C==-1){return ;}var A=parseFloat(navigator.userAgent.substring(C+5));if(A>=7){return ;}var E=document.getElementById(B);if(!E){return ;}var F=document.getElementById(B+":iframe");if(!F){F=document.createElement("iframe");F.src=D;F.setAttribute("id",B+":iframe");E.appendChild(F);}F.style.position="absolute";F.style.zIndex=-1;F.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=0)";F.style.left="0px";F.style.top="0px";F.style.width=E.offsetWidth+"px";F.style.height=E.offsetHeight+"px";}};Ice.DnD.adjustPosition=function(H){var C=$(H);var F=document.viewport.getDimensions();var B=C.getDimensions();var A=C.viewportOffset();var E=C.positionedOffset();var D=F.width-A.left-B.width;var G=F.height-A.top-B.height;if(A.left<0){C.style.left=E.left-A.left+"px";}else{if(D<0){C.style.left=E.left+D+"px";}}if(A.top<0){C.style.top=E.top-A.top+"px";}else{if(G<0){C.style.top=E.top+G+"px";}}};