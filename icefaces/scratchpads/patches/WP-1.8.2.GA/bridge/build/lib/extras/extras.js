Ice.DnD=Class.create();var IceLoaded=false;Ice.DnD.logger=Class.create();Ice.DnD.logger={debug:function(){},warn:function(){},error:function(){}};Ice.DnD={log:function(A){Ice.DnD.logger.debug(A);},DRAG_START:1,DRAG_CANCEL:2,DROPPED:3,HOVER_START:4,HOVER_END:5,init:function(){Ice.DnD.logger=window.logger.child("dragDrop");Ice.StateMon.logger=window.logger.child("stateMon");Ice.StateMon.destroyAll();IceLoaded=true;},elementReplaced:function(B){var A=$(B.id);return A!=null&&A!=B;},check:function(){Ice.StateMon.checkAll();},alreadyDrag:function(B){B=$(B);var A=false;$A(Draggables.drags).each(function(C){if(C.element&&C.element.id==B.id){A=true;}});return A;},sortableDraggable:function(B){B=$(B);var A=false;$A(Draggables.drags).each(function(C){if(C.element&&C.element.id==B.id){if(C.options.sort){A=true;}}});return A;},alreadyDrop:function(B){B=$(B);var A=false;$(Droppables.drops).each(function(C){if(C&&C.element.id==B.id){A=true;}});return A;},alreadySort:function(B){var A=Sortable.options(B);if(A){return true;}return false;}};Ice.PanelCollapsible={fire:function(A,E,B,G){var F=document.getElementById(A);var D=document.getElementById(E);try{if(Element.visible(F)){D.className=Ice.PanelCollapsible.getStyleClass(B,G,"ColpsdHdr");Ice.PanelCollapsible.collapse(A);}else{D.className=Ice.PanelCollapsible.getStyleClass(B,G,"Hdr");Ice.PanelCollapsible.expand(A);}}catch(C){console.log("Error in panel collapsible ["+C+"]");}},expand:function(A){var B=document.getElementById(A);if(!Element.visible(B)){Effect.SlideDown(A,{uploadCSS:true,submit:true,duration:0.5});}},collapse:function(A){var B=document.getElementById(A);if(Element.visible(B)){Effect.SlideUp(A,{uploadCSS:true,submit:true,duration:0.5});}},getStyleClass:function(A,C,D){var B=A+D;if(C!=null){B+=" "+C+D;}return B;}};Ice.tableRowClicked=function(A,B,C,M,K,G){var E=document.getElementsByName(K+"ctrKy");var I=document.getElementsByName(K+"sftKy");if(E.length>0){E=E[0];}else{E=null;}if(I.length>0){I=I[0];}else{I=null;}if(E&&A){E.value=A.ctrlKey||A.metaKey;}if(I&&A){I.value=A.shiftKey;}try{if(B){var J;if(!A){var A=window.event;}if(A.target){J=A.target;}else{if(A.srcElement){J=A.srcElement;}}if(J.nodeType==3){J=J.parentNode;}while(true){var O=J.tagName.toLowerCase();if(O=="tr"){break;}if(O=="input"||O=="select"||O=="option"||O=="a"||O=="textarea"){return ;}if(J.parentNode){J=J.parentNode;}else{break;}}}var L=Event.extend(A);var N=L.element();if(N.tagName.toLowerCase()!="tr"){N=L.element().up("tr[onclick*='Ice.tableRowClicked']");}if(N){if(G){N.className=G;N.onmouseover=Prototype.emptyFunction;N.onmouseout=Prototype.emptyFunction;}}var F=document.forms[M][K];F.value=C;var D=new Object();iceSubmitPartial(null,F,D);setFocus("");}catch(H){console.log("Error in rowSelector["+H+"]");}};Ice.clickEvents={};Ice.registerClick=function(F,A,E,D,J,G,K,B,C,I,H){if(!Ice.clickEvents[F.id]){Ice.clickEvents[F.id]=new Ice.clickEvent(F,A,E,D,J,G,K,B,C,I,H);}};Ice.registerDblClick=function(A){if(document.selection){document.selection.empty();}if(Ice.clickEvents[A.id]){Ice.clickEvents[A.id].submit(2);}};Ice.clickEvent=Class.create({initialize:function(F,A,E,D,J,G,K,B,C,I,H){this.elem=F;this.hdnClkRow=A;this.hdnClkCount=E;this.rowid=D;this.formId=J;if(G<0){this.delay=0;}else{if(G>1000){this.delay=1000;}else{this.delay=G;}}this.toggleOnClick=K;if(this.toggleOnClick){this.event=Object.clone(B);this.useEvent=C;this.hdnFld=I;this.toggleClassNames=H;}this.timer=setTimeout(this.submit.bind(this,1),this.delay);},submit:function(B){clearTimeout(this.timer);Ice.clickEvents[this.elem.id]=null;var A=document.forms[this.formId][this.hdnClkRow];A.value=this.rowid;var D=document.forms[this.formId][this.hdnClkCount];D.value=B;if(this.toggleOnClick){Ice.tableRowClicked(this.event,this.useEvent,this.rowid,this.formId,this.hdnFld,this.toggleClassNames);}else{var C=new Object();iceSubmitPartial(null,A,C);}}});Ice.preventTextSelection=function(A){if(Ice.isEventSourceInputElement(A)){return true;}else{Ice.disableTxtSelection(document.body);return false;}};Ice.disableTxtSelection=function(A){A.onselectstart=function(){return false;};A.onmousedown=function(B){return false;};};Ice.enableTxtSelection=function(A){A.onselectstart=function(){return true;};A.onmousedown=function(B){return true;};};Ice.txtAreaMaxLen=function(B,A){if(A>=0&&B.value.length>A){B.value=B.value.substring(0,A);}};Ice.isEventSourceInputElement=function(D){var B=D||window.event;var B=Event.extend(B);var C=B.element();var A=C.tagName.toLowerCase();if(A=="input"||A=="select"||A=="option"||A=="a"||A=="textarea"){return true;}else{return false;}};Ice.tabNavigator=function(D){var E=Event.element(D);var B=D.keyCode;switch(B){case 37:case 38:var A=E.up(".icePnlTb").previousSibling;if(A){var F=A.down(".icePnlTbLblLnk");if(F){F.focus();}}if(E.up(".icePnlTb")){if(D.preventDefault){D.preventDefault();}else{if(D.returnValue){D.returnValue=false;}}}break;case 39:case 40:var C=E.up(".icePnlTb").nextSibling;if(C&&Element.hasClassName(C,"icePnlTb")){var F=C.down(".icePnlTbLblLnk");if(F){F.focus();}}if(E.up(".icePnlTb")){if(D.preventDefault){D.preventDefault();}else{if(D.returnValue){D.returnValue=false;}}}break;}};Ice.pnlTabOnFocus=function(B,C,A){setFocus(B.id);if(A){Event.observe(B,"keydown",Ice.tabNavigator);}if(!C){return ;}Ice.simulateFocus(B.parentNode,B);};Ice.pnlTabOnBlur=function(B,C,A){if(A){Event.stopObserving(B,"keydown",Ice.tabNavigator);}if(!C){return ;}setFocus("");Ice.simulateBlur(B.parentNode,B);};Ice.pnlClpFocus=function(B){var A=B.parentNode;Ice.simulateFocus(A,B);A.style.padding="0px";};Ice.pnlClpBlur=function(B){var A=B.parentNode;Ice.simulateBlur(A,B);A.style.padding="1px";};Ice.simulateFocus=function(B,A){if(!document.all){A.style.visibility="hidden";}A.style.borderStyle="none";A.style.outlineStyle="none";A.style.borderWidth="0px";A.style.outlineWidth="0px";A.style.margin="0px";B._borderStyle=B.style.borderStyle;B.style.borderStyle="dotted";B._borderWidth=B.style.borderWidth;B.style.borderWidth="1px 1px 1px 1px";B._borderColor=B.style.borderColor;B.style.borderColor="black";};Ice.simulateBlur=function(B,A){if(!document.all){A.style.visibility="visible";}B.style.borderStyle=B._borderStyle;B.style.borderWidth=B._borderWidth;B.style.borderColor=B._borderColor;};Ice.DataExporterOpenWindow=function(A,G,B,C){var F=window.open(G);if(!F||typeof (F)=="undefined"){var E=$(A+"container").firstChild;var D=C=="null"?B:C;E.onclick=function(){window.open(G);};if(E.tagName=="INPUT"){E.value=D;}else{if(E.firstChild.tagName=="IMG"){E.firstChild.title=D;}else{E.innerHTML=D;}}}new Effect.Highlight(A+"container",{startcolor:"#fda505",endcolor:"#ffffff"});};